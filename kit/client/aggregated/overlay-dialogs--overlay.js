/* For licensing information see http://contextlysitescripts.contextly.com/kit/assets/dev/licenses.txt */
Contextly=window.Contextly||{},Contextly.createClass=function(data){var abstracts=data.abstracts||[],statics=data.statics||{},extend=data.extend||[];extend instanceof Array||(extend=[extend]);var constructor;constructor=data.construct?data.construct:extend.length?function(){for(var i=0;i<extend.length;i++)extend[i].apply(this,arguments)}:function(){};var proto={};delete data.construct,delete data.abstracts,delete data.statics,delete data.extend;for(var i=0;i<extend.length;i++){var parent=extend[i];"function"==typeof parent.construct&&parent.construct.call(constructor);for(var p in parent)"function"==typeof parent[p]&&"construct"!=p&&(constructor[p]=parent[p]);for(var p in parent.prototype)"function"==typeof parent.prototype[p]&&"constructor"!=p&&(proto[p]=parent.prototype[p])}if(statics.abstracts)for(var p=0;p<statics.abstracts.length;p++)proto[statics.abstracts[p]]=Contextly.abstractMethod(p);for(var p=0;p<abstracts.length;p++)proto[abstracts[p]]=Contextly.abstractMethod(p);proto.instanceOf=function(_class){if(arguments.length>1){for(var res=!0,i=0;i<arguments.length;i++)res=res&&this.instanceOf(arguments[i]);return res}if(constructor===_class)return!0;for(var i=0;i<extend.length;i++)if(extend[i].prototype.instanceOf.call(this,_class))return!0;return _class===Object};for(var p in data)"function"==typeof data[p]&&(proto[p]=data[p]);for(var p in statics)"function"==typeof statics[p]&&(constructor[p]=statics[p]);return"function"==typeof statics.construct&&statics.construct.call(constructor),constructor.prototype=proto,constructor.fn=proto,constructor},Contextly.abstractMethod=function(name){return function(){throw name?name+" is abstract method.":"Abstract method must not be called directly."}},function($){Contextly.Proxy=Contextly.createClass({proxy:function(func,passContext,passArguments){func.guid||(func.guid=$.guid++);var proxy,self=this;return proxy=passArguments?passContext?function(){return Array.prototype.unshift.call(arguments,this),func.apply(self,arguments)}:function(){return func.apply(self,arguments)}:passContext?function(){return func.call(self,this)}:function(){return func.call(self)},proxy.guid=func.guid,proxy},each:function(collection,func){return $.each(collection,this.proxy(func,!0,!0))},eachElement:function(elements,func){return this.each(elements,function(){return arguments[0]=$(arguments[0]),func.apply(this,arguments)})}})}(jQuery),function($){Contextly.overlay=Contextly.overlay||{},Contextly.overlay.Base=Contextly.createClass({extend:Contextly.Proxy.prototype,statics:{init:function(){if(!this.initialized){this.initialized=!0;var map={window:window,document:document,html:"html"};for(var key in map)this[key]=$(map[key]);this.animating=0}},ns:function(eventType){return eventType+".contextlyOverlay"},open:function(element,options){this.init(),this.animating||(this.setOptions(options),this.lockBodyScroll(),this.renderOverlay(),this.renderDialog(element),this.refreshDialogSizes(),this.broadcast(Contextly.overlay.broadcastTypes.BEFORE_OPEN),this.animateOpening())},renderOverlay:function(){return this.overlay?void this.overlay.show():(this.overlay=$('<div class="ctx-overlay" />').appendTo("body"),!0)},renderDialog:Contextly.abstractMethod(),getAnimatedElements:function(markAsAnimating){var elements=this.overlay.add(this.dialog);return markAsAnimating&&(this.animating=elements.length),elements},animateOpening:function(){this.getAnimatedElements(!0).css({opacity:0}).animate({opacity:1},{duration:this.options.duration,complete:this.proxy(this.onOpeningComplete)})},onAnimationComplete:function(){return this.animating--,this.animating<0&&(this.animating=0),!this.animating},onOpeningComplete:function(){this.onAnimationComplete()&&(this.bindHandlers(),this.broadcast(Contextly.overlay.broadcastTypes.AFTER_OPEN))},bindHandlers:function(){this.window.bind(this.ns("resize"),this.proxy(this.onWindowResize)),this.options.closeOnEsc&&this.window.bind(this.ns("keyup"),this.proxy(this.onKeyUp,!1,!0)),this.options.closeOnOverlayClick&&this.overlay.bind(this.ns("click"),this.proxy(this.close))},close:function(){this.animating||$.isFunction(this.options.onClose)&&this.options.onClose()===!1||(this.broadcast(Contextly.overlay.broadcastTypes.BEFORE_CLOSE),this.unbindHandlers(),this.animateClosing())},unbindHandlers:function(){this.window.unbind(this.ns("resize")).unbind(this.ns("keypress")),this.overlay.unbind(this.ns("click"))},animateClosing:function(){this.getAnimatedElements(!0).animate({opacity:0},{duration:this.options.duration,complete:this.proxy(this.onClosingComplete)})},onClosingComplete:function(){this.onAnimationComplete()&&(this.destroyDialog(),this.destroyOverlay(),this.unlockBodyScroll(),this.broadcast(Contextly.overlay.broadcastTypes.AFTER_CLOSE))},destroyDialog:Contextly.abstractMethod(),destroyOverlay:function(){this.overlay.hide()},onKeyUp:function(e){27===e.which&&this.close()},onWindowResize:function(){this.refreshDialogSizes()},setOptions:function(options){if(options){for(var sizes=["width","height"],i=0;i<sizes.length;i++){var size=sizes[i],type=typeof options[size];"undefined"===type||"number"!==type&&"string"!==type||(options[size]={value:options[size],min:0,max:0})}this.options=options.extend?$.extend(!0,this.options,options):$.extend(!0,this.getDefaultOptions(),options)}else this.options=this.getDefaultOptions()},getDefaultOptions:function(){return{spacing:40,duration:200,width:{value:"auto",min:0,max:0},height:{value:"auto",min:0,max:0},closeOnEsc:!0,closeOnOverlayClick:!0,extend:!1,onClose:null,dataKey:"contextlyOverlay"}},broadcast:function(type){return this.window.triggerHandler(type,[this])},setDialogDimension:function(dimension,dialogSize){this.dialog.css(dimension,dialogSize)},setDialogPosition:function(coordinate,windowSize,dialogSize){var dialogPosition=Math.floor((windowSize-dialogSize)/2);this.dialog.css(coordinate,dialogPosition)},refreshDialogSize:function(dimension,coordinate,options){var dialogSize,windowSize=this.window[dimension]();switch(options.value){case"window":dialogSize=windowSize-2*this.options.spacing,dialogSize=this.applyDialogSizeLimits(dialogSize,options),this.setDialogDimension(dimension,dialogSize),this.setDialogPosition(coordinate,windowSize,dialogSize);break;case"auto":var map={width:"outerWidth",height:"outerHeight"},dimensionFunc=map[dimension];dialogSize=this.dialog[dimensionFunc](),this.setDialogPosition(coordinate,windowSize,dialogSize);break;default:"number"!=typeof options.value&&$.error("Unsupported overlay "+dimension+" value: "+options.value),dialogSize=options.value,this.setDialogDimension(dimension,dialogSize),this.setDialogPosition(coordinate,windowSize,dialogSize)}},refreshDialogSizes:function(){var dimensions={width:"left",height:"top"};for(var dimension in dimensions){var coordinate=dimensions[dimension],sideOptions=this.options[dimension];this.refreshDialogSize(dimension,coordinate,sideOptions)}},applyDialogSizeLimits:function(value,limits){return limits.min&&value<limits.min?value=limits.min:limits.max&&value>limits.max&&(value=limits.max),value},lockBodyScroll:function(){var data={scroll:{top:this.window.scrollTop(),left:this.window.scrollLeft()},style:this.html.attr("style")},css={position:"fixed",top:-data.scroll.top,left:-data.scroll.left,width:"100%"};this.document.height()>this.window.height()&&(css["overflow-y"]="scroll"),this.html.data(this.options.dataKey,data).css(css)},unlockBodyScroll:function(){var data=this.html.data(this.options.dataKey);data&&(this.html.attr("style",data.style||" "),this.window.scrollTop(data.scroll.top).scrollLeft(data.scroll.left))}}}),Contextly.overlay.broadcastTypes={BEFORE_OPEN:"contextlyOverlayBeforeOpen",AFTER_OPEN:"contextlyOverlayAfterOpen",BEFORE_CLOSE:"contextlyOverlayBeforeClose",AFTER_CLOSE:"contextlyOverlayAfterClose"}}(jQuery),function($){Contextly.overlay.Default=Contextly.createClass({extend:Contextly.overlay.Base,statics:{renderOverlay:function(){var init=Contextly.overlay.Base.renderOverlay.apply(this,arguments);init&&this.overlay.addClass("ctx-default-overlay")},renderDialog:function(element){this.dialog?this.dialog.show():(this.dialog=$('<div class="ctx-overlay-dialog ctx-default-overlay-dialog" />').appendTo("body"),this.closeButton=$('<a href="javascript:" class="ctx-default-overlay-close"></a>').appendTo(this.dialog)),this.renderContent(element)},renderContent:function(element){this.content=element.appendTo(this.dialog)},destroyDialog:function(){this.destroyContent(),this.dialog.hide()},destroyContent:function(){this.content.remove(),delete this.content},bindHandlers:function(){Contextly.overlay.Base.bindHandlers.apply(this,arguments),this.closeButton.bind(this.ns("click"),this.proxy(this.close))},unbindHandlers:function(){Contextly.overlay.Base.unbindHandlers.apply(this,arguments),this.closeButton.unbind(this.ns("click"))}}})}(jQuery),function($){Contextly.overlay.Editor=Contextly.createClass({extend:Contextly.overlay.Default,statics:{renderContent:function(url){this.content=$('<iframe frameBorder="0" class="ctx-editor-overlay-iframe" />').attr({src:url,width:"100%",height:"100%"}).prependTo(this.dialog)},getDefaultOptions:function(){var options=Contextly.overlay.Base.getDefaultOptions.apply(this,arguments);return options=$.extend(!0,options,{width:{value:"window",max:1400},height:{value:"window"},closeOnEsc:!1,closeOnOverlayClick:!1})}}})}(jQuery);
//# sourceMappingURL=overlay-dialogs--overlay.map